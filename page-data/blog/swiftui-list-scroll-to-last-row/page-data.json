{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/swiftui-list-scroll-to-last-row/","result":{"data":{"markdownRemark":{"html":"<ul>\n<li>SwiftUI <code class=\"language-text\">List</code>의 마지막 row부터 보여주고 싶을때가 있다.</li>\n<li>예를들면 채팅뷰의 메세지 List이다. 시간 순서대로 나열된 메세지 List가 있을때, 가장 최신 메세지 (last row)를 먼저 보여줘야하는 경우다.</li>\n<li>List의 last row가 화면의 bottom에 먼저 보이게 하기 위해서, List가 처음 그려질때 last row로 재빠르게 scroll 해주는 방법으로 원하는 UX를 구현할 수 있다.</li>\n</ul>\n<h2>기본 채팅뷰 코드 셋업</h2>\n<ul>\n<li>총 50개의 메세지가 있는 채팅방을 가정한다.</li>\n<li>메세지는 \"message 0\" 부터 \"message 49\"까지 있고, 숫자가 작을수록 예전 메세지, 클수록 최신 메세지이다. 가장 최신 메세지는 \"message 49\"이다.</li>\n<li><code class=\"language-text\">ChatRoom</code> 뷰에는 각 row에 message를 보여주는 <code class=\"language-text\">List</code>가 있다.</li>\n<li><code class=\"language-text\">ChatRoom</code>에서 <code class=\"language-text\">messages</code> 데이터는 <code class=\"language-text\">ChatRoomViewModel</code>을 통해 init, load 된다.\n<ul>\n<li><code class=\"language-text\">ChatRoom</code>이 <code class=\"language-text\">init()</code> 될때 <code class=\"language-text\">viewModel.messages = []</code>로 초기화된다.</li>\n<li><code class=\"language-text\">ChatRoom</code>이 처음 화면에 나타날때 (<code class=\"language-text\">.onAppear()</code>) viewModel을 통해서 50개의 메세지를 불러온다 (<code class=\"language-text\">viewModel.loadMessages()</code>). (실제 환경에서는 네트워킹이나 로컬 디비에서 메세지를 불러오겠지만, 여기 예시에서는 단순화하기 위해서 코드로 messages array를 채웠다)</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-swift line-numbers\"><code class=\"language-swift\"><span class=\"token keyword\">import</span> <span class=\"token class-name\">Foundation</span>\n<span class=\"token keyword\">import</span> <span class=\"token class-name\">SwiftUI</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Message</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">Identifiable</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Equatable</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> id <span class=\"token operator\">=</span> <span class=\"token function\">UUID</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">var</span> text<span class=\"token punctuation\">:</span> <span class=\"token class-name\">String</span>\n    \n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">:</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> text\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">func</span> <span class=\"token operator\">==</span> <span class=\"token punctuation\">(</span>lhs<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Message</span><span class=\"token punctuation\">,</span> rhs<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Message</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token class-name\">Bool</span> <span class=\"token punctuation\">{</span>\n        lhs<span class=\"token punctuation\">.</span>id <span class=\"token operator\">==</span> rhs<span class=\"token punctuation\">.</span>id\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ChatRoomViewModel</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">ObservableObject</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token attribute atrule\">@Published</span> <span class=\"token keyword\">var</span> messages <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token class-name\">Message</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token comment\">// 실제로는 서버나 로컬 스토리지에서 메세지를 로딩해오는 함수</span>\n    <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">loadMessages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">for</span> number <span class=\"token keyword\">in</span> <span class=\"token number\">0</span><span class=\"token operator\">..&lt;</span><span class=\"token number\">50</span> <span class=\"token punctuation\">{</span>\n            messages<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Message</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"message </span><span class=\"token interpolation-punctuation punctuation\">\\(</span><span class=\"token interpolation\">number</span><span class=\"token interpolation-punctuation punctuation\">)</span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">struct</span> <span class=\"token class-name\">ChatRoom</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token attribute atrule\">@ObservedObject</span> <span class=\"token keyword\">var</span> viewModel <span class=\"token operator\">=</span> <span class=\"token class-name\">ChatRoomViewModel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">var</span> body<span class=\"token punctuation\">:</span> <span class=\"token keyword\">some</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">List</span><span class=\"token punctuation\">(</span>viewModel<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> message <span class=\"token keyword\">in</span>\n            <span class=\"token class-name\">Text</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">.</span>onAppear <span class=\"token punctuation\">{</span>\n            viewModel<span class=\"token punctuation\">.</span><span class=\"token function\">loadMessages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">struct</span> <span class=\"token class-name\">ContentView</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> body<span class=\"token punctuation\">:</span> <span class=\"token keyword\">some</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">ChatRoom</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>화면을 programmatically scroll하기 (ScrollViewReader, ScrollViewProxy)</h2>\n<ul>\n<li>Programmatic scroll을 하기 위해서는 <a href=\"https://developer.apple.com/documentation/swiftui/scrollviewreader\"><code class=\"language-text\">ScrollViewReader</code></a>을 사용한다.</li>\n<li>아래 코드에서 Scroll to Bottom 버튼을 누르면 화면이 아래로 스크롤된다.</li>\n<li>(참고) Scroll to Bottom 버튼 추가를 위해 임의로 VStack을 추가했다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-swift line-numbers\"><code class=\"language-swift\"><span class=\"token comment\">// ChatRoom 외의 다른 코드는 동일</span>\n<span class=\"token operator\">...</span>\n\n<span class=\"token keyword\">struct</span> <span class=\"token class-name\">ChatRoom</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token attribute atrule\">@ObservedObject</span> <span class=\"token keyword\">var</span> viewModel <span class=\"token operator\">=</span> <span class=\"token class-name\">ChatRoomViewModel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">var</span> body<span class=\"token punctuation\">:</span> <span class=\"token keyword\">some</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token class-name\">ScrollViewReader</span> <span class=\"token punctuation\">{</span> proxy <span class=\"token keyword\">in</span></span>            <span class=\"token class-name\">VStack</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token class-name\">List</span><span class=\"token punctuation\">(</span>viewModel<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> message <span class=\"token keyword\">in</span>\n                    <span class=\"token class-name\">Text</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n<span class=\"gatsby-highlight-code-line\">                        <span class=\"token punctuation\">.</span><span class=\"token function\">id</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span></span>                <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">.</span>onAppear <span class=\"token punctuation\">{</span>\n                    viewModel<span class=\"token punctuation\">.</span><span class=\"token function\">loadMessages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">}</span>\n                \n                <span class=\"token class-name\">Button</span><span class=\"token punctuation\">(</span><span class=\"token string-literal\"><span class=\"token string\">\"Scroll to Bottom\"</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">                    proxy<span class=\"token punctuation\">.</span><span class=\"token function\">scrollTo</span><span class=\"token punctuation\">(</span>viewModel<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">.</span>last<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span></span>                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token punctuation\">}</span></span>    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>ChatRoom이 사용자에게 처음 보여질때 last row로 scroll하기</h2>\n<ul>\n<li>우리의 의도는 ChatRoom이 화면에 나타날때 재빠르게 List를 마지막 줄로 스크롤하기이다.</li>\n<li>ChatRoom이 화면에 나타나는 타이밍은 <code class=\"language-text\">.onAppear()</code> 시점이므로, 위 코드의 <code class=\"language-text\">proxy.scrollTo(...)</code> 함수를 List의 <code class=\"language-text\">.onAppear()</code>에서 호출한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-swift line-numbers\"><code class=\"language-swift\"><span class=\"token keyword\">struct</span> <span class=\"token class-name\">ChatRoom</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token attribute atrule\">@ObservedObject</span> <span class=\"token keyword\">var</span> viewModel <span class=\"token operator\">=</span> <span class=\"token class-name\">ChatRoomViewModel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">var</span> body<span class=\"token punctuation\">:</span> <span class=\"token keyword\">some</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">ScrollViewReader</span> <span class=\"token punctuation\">{</span> proxy <span class=\"token keyword\">in</span>\n            <span class=\"token class-name\">List</span><span class=\"token punctuation\">(</span>viewModel<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> message <span class=\"token keyword\">in</span>\n                <span class=\"token class-name\">Text</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">.</span><span class=\"token function\">id</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">.</span>onAppear <span class=\"token punctuation\">{</span>\n                viewModel<span class=\"token punctuation\">.</span><span class=\"token function\">loadMessages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"gatsby-highlight-code-line\">                proxy<span class=\"token punctuation\">.</span><span class=\"token function\">scrollTo</span><span class=\"token punctuation\">(</span>viewModel<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">.</span>last<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span></span>            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>슬프게도 의도대로 작동하지 않는다. 그 이유와 해결법을 다음 섹션에서 알아본다.</li>\n</ul>\n<h2>ChatRoom의 messages 데이터에 변화가 발생할때 last row로 scroll하기</h2>\n<ul>\n<li>List의 onAppear에서 <code class=\"language-text\">scrollTo(viewModel.messages.last?.id)</code>가 작동하지 않는 이유:\n<ul>\n<li><code class=\"language-text\">.onAppear()</code>이 불리는 시점에는 <code class=\"language-text\">messages = []</code> 데이터가 비어있어서 List의 child view들이 생성되지 않았기 때문이다.</li>\n<li>List 내부 뷰가 화면을 넘어가 있어야 스크롤이 작동하는데, 아무 row가 그려져있지 않아있어서 스크롤 할 뷰가 없는 것이다.</li>\n</ul>\n</li>\n<li><code class=\"language-text\">.onAppear()</code>에서 <code class=\"language-text\">viewModel.loadMessages()</code>가 호출된 후에야 <code class=\"language-text\">messages</code>값이 채워지고, 이로 인해서 List의 row 뷰들이 생성된다.</li>\n</ul>\n<br>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 2220px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/26ecbdf50c7673e059a70c0de3dc1a8a/13bda/viewState1.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 42.85%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAACE4AAAhOAFFljFgAAABKElEQVR42o2SiW7DIBBE/f//2LSJo/gAO7HBBtvAq9YJaSq1UlYadriGWaAwxuC9J6VEjAlrLW3bolRL12n6vt/HBXmN5MxzX8I5R6G1RkRzWGsegj1NI1kTQrhPpkdKd+TIXIwVSimWZeE2wEcZODeJ/gZVszGaxGjgeIk7znXkUEaqNnJpI4dz5HSJ6C7S9YnrzVGIaoyRdQNjA2YKTHNgHFd0Z9HaMJqN2YPzMDnwC7jlzmfpr+z7p9lT/NiW+wh7XSkGjHUcTw2fXxWz7H4j9pLrut6JRL4rcWytQ6mBVg14sUB6T3Dbtl1AHGYewoadFvqrRXcDy7I+X/Y/PF/59QRxKN9GSnd+o6oUZVntgm+XLE2GnDBN0yO7X+Ov6/6C/JRxHPkG0q2/IzKzBmQAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"viewState1\" title=\"\" src=\"/static/26ecbdf50c7673e059a70c0de3dc1a8a/13bda/viewState1.png\" srcset=\"/static/26ecbdf50c7673e059a70c0de3dc1a8a/f97d7/viewState1.png 2000w,\n/static/26ecbdf50c7673e059a70c0de3dc1a8a/13bda/viewState1.png 2220w\" sizes=\"(max-width: 2220px) 100vw, 2220px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<br>\n<ul>\n<li>이런 작동 방식을 기반으로, 아래처럼 List의 <code class=\"language-text\">.onChange()</code>를 이용해서 <code class=\"language-text\">scrollTo()</code>를 호출해야 의도대로 작동한다.</li>\n<li><code class=\"language-text\">viewModel.messages</code>가 바뀌는 타이밍에 <code class=\"language-text\">scrollTo()</code>를 호출한다.</li>\n<li>이때 <code class=\"language-text\">oldValue.isEmpty</code> 조건은 ChatRoom 뷰가 처음 나타날때에만 <code class=\"language-text\">scrollTo()</code>를 호출하기 위한것이다. 이 조건을 확인하지 않으면 <code class=\"language-text\">messages</code> 데이터가 바뀔때마다 <code class=\"language-text\">scrollTo()</code>가 호출된다.</li>\n</ul>\n<br>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 2220px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/97a9d35ddcabc5c8cf09acc0b633a1f7/13bda/viewState.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 42.85%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAACE4AAAhOAFFljFgAAABXUlEQVR42l2SiXLkIAxE/f//uDvJehJfgI3BBg/H2wLHk0xU1SVKEi21oDHG4L0n50xKGWst4zgyTSNSCpRSNV6QM3h/oLVGSFH9PM/1fjHnHI0QgkJ6mbXmi1AxDMULYozPfLlUmpw1E0pKtm37ynmaEjyOg0XDnzZyHzJqgW4IrCazGnj/TBX3PnG7J0YJH0Pk7z3RS5iXhFSZeXE0ZdyUEo8AxkbMFtn2yLo+ENIihGE1gd2D82Dd6XeXmaTjo9Oo2XEE2HZPc0k5d1ikZXKKGOt4/zdwe+vY3cFvizEjpeH29okQusaK0qbv++dSr12Via11TJNmnDTeP2qjV8LEsmwMo0LrrQ5UCUMIlaAErnOMAbsdqNkipOY4HjX/EyEklLK07YBS6/crv3aN9dsU6c4Hum6ibbtK+NsKobEb+37iKbnIvVA6lC9wevcS/1n3Xbuz7ycK2bqu/AeWWrp+hISeKQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"viewState\" title=\"\" src=\"/static/97a9d35ddcabc5c8cf09acc0b633a1f7/13bda/viewState.png\" srcset=\"/static/97a9d35ddcabc5c8cf09acc0b633a1f7/f97d7/viewState.png 2000w,\n/static/97a9d35ddcabc5c8cf09acc0b633a1f7/13bda/viewState.png 2220w\" sizes=\"(max-width: 2220px) 100vw, 2220px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-swift line-numbers\"><code class=\"language-swift\"><span class=\"token keyword\">struct</span> <span class=\"token class-name\">ChatRoom</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token attribute atrule\">@ObservedObject</span> <span class=\"token keyword\">var</span> viewModel <span class=\"token operator\">=</span> <span class=\"token class-name\">ChatRoomViewModel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">var</span> body<span class=\"token punctuation\">:</span> <span class=\"token keyword\">some</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">ScrollViewReader</span> <span class=\"token punctuation\">{</span> proxy <span class=\"token keyword\">in</span>\n            <span class=\"token class-name\">List</span><span class=\"token punctuation\">(</span>viewModel<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> message <span class=\"token keyword\">in</span>\n                <span class=\"token class-name\">Text</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">.</span><span class=\"token function\">id</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">.</span>onAppear <span class=\"token punctuation\">{</span>\n                        <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-literal\"><span class=\"token string\">\"MessageView onAppear. (</span><span class=\"token interpolation-punctuation punctuation\">\\(</span><span class=\"token interpolation\">message<span class=\"token punctuation\">.</span>text</span><span class=\"token interpolation-punctuation punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">)</span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">.</span>onAppear <span class=\"token punctuation\">{</span>\n                viewModel<span class=\"token punctuation\">.</span><span class=\"token function\">loadMessages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n<span class=\"gatsby-highlight-code-line\">            <span class=\"token punctuation\">.</span><span class=\"token function\">onChange</span><span class=\"token punctuation\">(</span>of<span class=\"token punctuation\">:</span> viewModel<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> oldValue<span class=\"token punctuation\">,</span> newValue <span class=\"token keyword\">in</span></span><span class=\"gatsby-highlight-code-line\">                <span class=\"token keyword\">if</span> oldValue<span class=\"token punctuation\">.</span>isEmpty <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">                    proxy<span class=\"token punctuation\">.</span><span class=\"token function\">scrollTo</span><span class=\"token punctuation\">(</span>viewModel<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">.</span>last<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span></span>                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>Full Code</h2>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-swift line-numbers\"><code class=\"language-swift\">\n<span class=\"token keyword\">import</span> <span class=\"token class-name\">Foundation</span>\n<span class=\"token keyword\">import</span> <span class=\"token class-name\">SwiftUI</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Message</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">Identifiable</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Equatable</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> id <span class=\"token operator\">=</span> <span class=\"token function\">UUID</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">var</span> text<span class=\"token punctuation\">:</span> <span class=\"token class-name\">String</span>\n    \n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">:</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> text\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">func</span> <span class=\"token operator\">==</span> <span class=\"token punctuation\">(</span>lhs<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Message</span><span class=\"token punctuation\">,</span> rhs<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Message</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token class-name\">Bool</span> <span class=\"token punctuation\">{</span>\n        lhs<span class=\"token punctuation\">.</span>id <span class=\"token operator\">==</span> rhs<span class=\"token punctuation\">.</span>id\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ChatRoomViewModel</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">ObservableObject</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token attribute atrule\">@Published</span> <span class=\"token keyword\">var</span> messages <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token class-name\">Message</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">loadMessages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">for</span> number <span class=\"token keyword\">in</span> <span class=\"token number\">0</span><span class=\"token operator\">..&lt;</span><span class=\"token number\">50</span> <span class=\"token punctuation\">{</span>\n            messages<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Message</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"message </span><span class=\"token interpolation-punctuation punctuation\">\\(</span><span class=\"token interpolation\">number</span><span class=\"token interpolation-punctuation punctuation\">)</span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-literal\"><span class=\"token string\">\"message </span><span class=\"token interpolation-punctuation punctuation\">\\(</span><span class=\"token interpolation\">number</span><span class=\"token interpolation-punctuation punctuation\">)</span><span class=\"token string\"> loaded.\"</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">struct</span> <span class=\"token class-name\">ChatRoom</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token attribute atrule\">@ObservedObject</span> <span class=\"token keyword\">var</span> viewModel <span class=\"token operator\">=</span> <span class=\"token class-name\">ChatRoomViewModel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">var</span> body<span class=\"token punctuation\">:</span> <span class=\"token keyword\">some</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">ScrollViewReader</span> <span class=\"token punctuation\">{</span> proxy <span class=\"token keyword\">in</span>\n            <span class=\"token class-name\">List</span><span class=\"token punctuation\">(</span>viewModel<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> message <span class=\"token keyword\">in</span>\n                <span class=\"token class-name\">Text</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">.</span><span class=\"token function\">id</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">.</span>onAppear <span class=\"token punctuation\">{</span>\n                        <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-literal\"><span class=\"token string\">\"MessageView onAppear. (</span><span class=\"token interpolation-punctuation punctuation\">\\(</span><span class=\"token interpolation\">message<span class=\"token punctuation\">.</span>text</span><span class=\"token interpolation-punctuation punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">)</span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">.</span>onAppear <span class=\"token punctuation\">{</span>\n                viewModel<span class=\"token punctuation\">.</span><span class=\"token function\">loadMessages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">onChange</span><span class=\"token punctuation\">(</span>of<span class=\"token punctuation\">:</span> viewModel<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> oldValue<span class=\"token punctuation\">,</span> newValue <span class=\"token keyword\">in</span>\n                <span class=\"token keyword\">if</span> oldValue<span class=\"token punctuation\">.</span>isEmpty <span class=\"token punctuation\">{</span>\n                    proxy<span class=\"token punctuation\">.</span><span class=\"token function\">scrollTo</span><span class=\"token punctuation\">(</span>viewModel<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">.</span>last<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">struct</span> <span class=\"token class-name\">MessageView</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> message<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Message</span>\n    \n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Message</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-literal\"><span class=\"token string\">\"MessageView.init(). (</span><span class=\"token interpolation-punctuation punctuation\">\\(</span><span class=\"token interpolation\">message<span class=\"token punctuation\">.</span>text</span><span class=\"token interpolation-punctuation punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">)</span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>message <span class=\"token operator\">=</span> message\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">var</span> body<span class=\"token punctuation\">:</span> <span class=\"token keyword\">some</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">Text</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span>onAppear <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-literal\"><span class=\"token string\">\"Text onAppear. (</span><span class=\"token interpolation-punctuation punctuation\">\\(</span><span class=\"token interpolation\">message<span class=\"token punctuation\">.</span>text</span><span class=\"token interpolation-punctuation punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">)</span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">struct</span> <span class=\"token class-name\">ContentView</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> body<span class=\"token punctuation\">:</span> <span class=\"token keyword\">some</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">ChatRoom</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","frontmatter":{"title":"SwiftUI List의 last row를 가장 먼저 보여주기","date":"Apr 27, 2024","intro":"SwiftUI에서 List가 처음 그려질때, 마지막 row부터 보여주는 방법에 대해 알아본다. ScrollViewReader, ScrollViewProxy를 이용해서 scroll 기능을 구현하고, 데이터가 뷰에 로드 되는 타이밍에 맞춰서 List의 last row로 scroll을 구현한다.","tags":["SwiftUI"],"featuredImage":null}}},"pageContext":{"slug":"/blog/2024-04-27-swiftui-list-scroll-to-last-row/2024-04-27-swiftui-list-scroll-to-last-row/"}},"staticQueryHashes":["2626414135","3159585216"],"slicesMap":{}}